{
  "summary": "Execute Protocol Flow",
  "description": "Execute a single step_run_id with QA by calling the DevGodzilla API (via API-wrapper scripts).",
  "value": {
    "modules": [
      {
        "id": "execute_step",
        "value": {
          "type": "script",
          "path": "u/devgodzilla/step_execute_api"
        },
        "input_transforms": {
          "step_run_id": { "type": "javascript", "expr": "flow_input.step_run_id" }
        }
      },
      {
        "id": "run_qa",
        "value": {
          "type": "script",
          "path": "u/devgodzilla/step_run_qa_api"
        },
        "input_transforms": {
          "step_run_id": { "type": "javascript", "expr": "flow_input.step_run_id" },
          "gates": { "type": "javascript", "expr": "flow_input.gates || null" }
        }
      }
    ]
  },
  "schema": {
        "type": "object",
        "$schema": "https://json-schema.org/draft/2020-12/schema",
    "properties": {
      "step_run_id": { "type": "integer", "description": "Step run ID", "default": 1 },
      "gates": {
        "type": [ "array", "null" ],
        "items": { "type": "string" },
        "description": "Optional QA gates list (lint, type, test)",
        "default": null
      }
    },
    "required": [
      "step_run_id"
    ]
  }
}
